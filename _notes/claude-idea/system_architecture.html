<svg viewBox="0 0 1400 1000" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .title {
        font-family: serif;
        font-size: 24px;
        font-weight: bold;
        fill: #2d5142;
      }
      .subtitle {
        font-family: sans-serif;
        font-size: 14px;
        fill: #666;
      }
      .layer-box {
        fill: #ffffff;
        stroke: #3d6152;
        stroke-width: 2;
        rx: 12;
      }
      .frontend-box {
        fill: #f0f9ff;
        stroke: #0ea5e9;
        stroke-width: 2;
        rx: 8;
      }
      .backend-box {
        fill: #fff7ed;
        stroke: #c18856;
        stroke-width: 2;
        rx: 8;
      }
      .external-box {
        fill: #f0fdf4;
        stroke: #10b981;
        stroke-width: 2;
        rx: 8;
      }
      .infrastructure-box {
        fill: #fef3f2;
        stroke: #ef4444;
        stroke-width: 2;
        rx: 8;
      }
      .component-title {
        font-family: serif;
        font-size: 14px;
        font-weight: bold;
        fill: #2d5142;
      }
      .component-text {
        font-family: sans-serif;
        font-size: 11px;
        fill: #333;
      }
      .tech-text {
        font-family: monospace;
        font-size: 10px;
        fill: #666;
      }
      .arrow {
        stroke: #3d6152;
        stroke-width: 2;
        fill: none;
        marker-end: url(#arrowhead);
      }
      .data-arrow {
        stroke: #c18856;
        stroke-width: 2;
        fill: none;
        marker-end: url(#dataArrowhead);
        stroke-dasharray: 5, 5;
      }
      .api-arrow {
        stroke: #10b981;
        stroke-width: 2;
        fill: none;
        marker-end: url(#apiArrowhead);
      }
      .section-label {
        font-family: sans-serif;
        font-size: 16px;
        font-weight: bold;
        fill: #8b7355;
      }
      .layer-label {
        font-family: sans-serif;
        font-size: 18px;
        font-weight: bold;
        fill: #2d5142;
      }
      .note-text {
        font-family: sans-serif;
        font-size: 10px;
        fill: #666;
      }
    </style>
    <marker
      id="arrowhead"
      markerWidth="10"
      markerHeight="7"
      refX="9"
      refY="3.5"
      orient="auto"
    >
      <polygon points="0 0, 10 3.5, 0 7" fill="#3D6152" />
    </marker>
    <marker
      id="dataArrowhead"
      markerWidth="10"
      markerHeight="7"
      refX="9"
      refY="3.5"
      orient="auto"
    >
      <polygon points="0 0, 10 3.5, 0 7" fill="#C18856" />
    </marker>
    <marker
      id="apiArrowhead"
      markerWidth="10"
      markerHeight="7"
      refX="9"
      refY="3.5"
      orient="auto"
    >
      <polygon points="0 0, 10 3.5, 0 7" fill="#10B981" />
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1400" height="1000" fill="#FAF7F2" />

  <!-- Title -->
  <text x="700" y="30" text-anchor="middle" class="title">
    EMC Yoga School システムアーキテクチャ図
  </text>
  <text x="700" y="50" text-anchor="middle" class="subtitle">
    フルスタック構成とデータフロー
  </text>

  <!-- Layer Labels -->
  <text x="50" y="90" class="layer-label">プレゼンテーション層</text>
  <text x="50" y="280" class="layer-label">アプリケーション層</text>
  <text x="50" y="500" class="layer-label">データ層</text>
  <text x="50" y="700" class="layer-label">外部サービス層</text>
  <text x="50" y="850" class="layer-label">インフラ層</text>

  <!-- Presentation Layer -->
  <rect x="100" y="100" width="1200" height="150" class="layer-box" />

  <!-- Web Frontend -->
  <rect x="150" y="120" width="200" height="110" class="frontend-box" />
  <text x="250" y="140" text-anchor="middle" class="component-title">
    Web Frontend
  </text>
  <text x="160" y="160" class="component-text">• React 18 + TypeScript</text>
  <text x="160" y="175" class="component-text">• Next.js (App Router)</text>
  <text x="160" y="190" class="component-text">• Tailwind CSS + shadcn/ui</text>
  <text x="160" y="205" class="component-text">• Responsive Design</text>
  <text x="160" y="220" class="tech-text">Vercel でホスティング</text>

  <!-- Mobile Experience -->
  <rect x="400" y="120" width="200" height="110" class="frontend-box" />
  <text x="500" y="140" text-anchor="middle" class="component-title">
    モバイル体験
  </text>
  <text x="410" y="160" class="component-text">• Progressive Web App</text>
  <text x="410" y="175" class="component-text">• タッチ最適化UI</text>
  <text x="410" y="190" class="component-text">• オフライン対応</text>
  <text x="410" y="205" class="component-text">• プッシュ通知</text>
  <text x="410" y="220" class="tech-text">iOS/Android 対応</text>

  <!-- Admin Dashboard -->
  <rect x="650" y="120" width="200" height="110" class="frontend-box" />
  <text x="750" y="140" text-anchor="middle" class="component-title">
    管理者ダッシュボード
  </text>
  <text x="660" y="160" class="component-text">• 統計・分析画面</text>
  <text x="660" y="175" class="component-text">• ユーザー管理</text>
  <text x="660" y="190" class="component-text">• コンテンツ管理</text>
  <text x="660" y="205" class="component-text">• レポート出力</text>
  <text x="660" y="220" class="tech-text">Role-based Access</text>

  <!-- State Management -->
  <rect x="900" y="120" width="200" height="110" class="frontend-box" />
  <text x="1000" y="140" text-anchor="middle" class="component-title">
    状態管理
  </text>
  <text x="910" y="160" class="component-text">• Zustand (Global State)</text>
  <text x="910" y="175" class="component-text">
    • React Query (Server State)
  </text>
  <text x="910" y="190" class="component-text">• React Hook Form</text>
  <text x="910" y="205" class="component-text">• Context API</text>
  <text x="910" y="220" class="tech-text">Type-safe State</text>

  <!-- Application Layer -->
  <rect x="100" y="290" width="1200" height="180" class="layer-box" />

  <!-- Authentication -->
  <rect x="150" y="310" width="180" height="140" class="backend-box" />
  <text x="240" y="330" text-anchor="middle" class="component-title">
    認証・認可
  </text>
  <text x="160" y="350" class="component-text">• Supabase Auth</text>
  <text x="160" y="365" class="component-text">• JWT + Refresh Token</text>
  <text x="160" y="380" class="component-text">• Role-based Access</text>
  <text x="160" y="395" class="component-text">• Password Reset</text>
  <text x="160" y="410" class="component-text">• Session Management</text>
  <text x="160" y="425" class="component-text">• Social Login (Future)</text>
  <text x="160" y="440" class="tech-text">Security: bcrypt hash</text>

  <!-- API Gateway -->
  <rect x="370" y="310" width="180" height="140" class="backend-box" />
  <text x="460" y="330" text-anchor="middle" class="component-title">
    API Gateway
  </text>
  <text x="380" y="350" class="component-text">• Supabase REST API</text>
  <text x="380" y="365" class="component-text">• Real-time Subscriptions</text>
  <text x="380" y="380" class="component-text">• Row Level Security</text>
  <text x="380" y="395" class="component-text">• Auto-generated API</text>
  <text x="380" y="410" class="component-text">• PostgreSQL Functions</text>
  <text x="380" y="425" class="component-text">• Edge Functions</text>
  <text x="380" y="440" class="tech-text">PostgREST based</text>

  <!-- Business Logic -->
  <rect x="590" y="310" width="180" height="140" class="backend-box" />
  <text x="680" y="330" text-anchor="middle" class="component-title">
    ビジネスロジック
  </text>
  <text x="600" y="350" class="component-text">• 学習進捗管理</text>
  <text x="600" y="365" class="component-text">• コンテンツ配信制御</text>
  <text x="600" y="380" class="component-text">• 通知システム</text>
  <text x="600" y="395" class="component-text">• レポート生成</text>
  <text x="600" y="410" class="component-text">• バッチ処理</text>
  <text x="600" y="425" class="component-text">• 統計計算</text>
  <text x="600" y="440" class="tech-text">PostgreSQL Functions</text>

  <!-- File Storage -->
  <rect x="810" y="310" width="180" height="140" class="backend-box" />
  <text x="900" y="330" text-anchor="middle" class="component-title">
    ファイル管理
  </text>
  <text x="820" y="350" class="component-text">• Supabase Storage</text>
  <text x="820" y="365" class="component-text">• 画像最適化</text>
  <text x="820" y="380" class="component-text">• PDF資料管理</text>
  <text x="820" y="395" class="component-text">• アクセス制御</text>
  <text x="820" y="410" class="component-text">• CDN配信</text>
  <text x="820" y="425" class="component-text">• 自動バックアップ</text>
  <text x="820" y="440" class="tech-text">S3 Compatible</text>

  <!-- Monitoring -->
  <rect x="1030" y="310" width="180" height="140" class="backend-box" />
  <text x="1120" y="330" text-anchor="middle" class="component-title">
    監視・ログ
  </text>
  <text x="1040" y="350" class="component-text">• Vercel Analytics</text>
  <text x="1040" y="365" class="component-text">• Sentry (Error Tracking)</text>
  <text x="1040" y="380" class="component-text">• Performance Monitoring</text>
  <text x="1040" y="395" class="component-text">• User Behavior Analytics</text>
  <text x="1040" y="410" class="component-text">• Real-time Alerts</text>
  <text x="1040" y="425" class="component-text">• Custom Dashboards</text>
  <text x="1040" y="440" class="tech-text">Observability Suite</text>

  <!-- Data Layer -->
  <rect x="100" y="510" width="1200" height="160" class="layer-box" />

  <!-- Primary Database -->
  <rect x="200" y="530" width="250" height="120" class="backend-box" />
  <text x="325" y="550" text-anchor="middle" class="component-title">
    メインデータベース
  </text>
  <text x="210" y="570" class="component-text">• PostgreSQL 15</text>
  <text x="210" y="585" class="component-text">• Row Level Security (RLS)</text>
  <text x="210" y="600" class="component-text">• Real-time Subscriptions</text>
  <text x="210" y="615" class="component-text">• 自動インデックス最適化</text>
  <text x="210" y="630" class="component-text">• Point-in-time Recovery</text>
  <text x="210" y="645" class="tech-text">Supabase Managed PostgreSQL</text>

  <!-- Cache Layer -->
  <rect x="500" y="530" width="200" height="120" class="backend-box" />
  <text x="600" y="550" text-anchor="middle" class="component-title">
    キャッシュ層
  </text>
  <text x="510" y="570" class="component-text">• Redis (Supabase)</text>
  <text x="510" y="585" class="component-text">• Session Storage</text>
  <text x="510" y="600" class="component-text">• Query Result Cache</text>
  <text x="510" y="615" class="component-text">• Real-time Data Cache</text>
  <text x="510" y="630" class="component-text">• CDN Edge Caching</text>
  <text x="510" y="645" class="tech-text">In-memory Performance</text>

  <!-- Backup & Recovery -->
  <rect x="750" y="530" width="200" height="120" class="backend-box" />
  <text x="850" y="550" text-anchor="middle" class="component-title">
    バックアップ
  </text>
  <text x="760" y="570" class="component-text">• 自動日次バックアップ</text>
  <text x="760" y="585" class="component-text">• Point-in-time Recovery</text>
  <text x="760" y="600" class="component-text">• Multi-region Replication</text>
  <text x="760" y="615" class="component-text">• Disaster Recovery</text>
  <text x="760" y="630" class="component-text">• Data Export/Import</text>
  <text x="760" y="645" class="tech-text">99.9% Uptime SLA</text>

  <!-- External Services Layer -->
  <rect x="100" y="710" width="1200" height="110" class="layer-box" />

  <!-- YouTube API -->
  <rect x="150" y="730" width="180" height="70" class="external-box" />
  <text x="240" y="750" text-anchor="middle" class="component-title">
    YouTube API
  </text>
  <text x="160" y="770" class="component-text">• 動画埋め込み</text>
  <text x="160" y="785" class="component-text">• 進捗追跡</text>
  <text x="160" y="800" class="tech-text">Player API v3</text>

  <!-- Email Service -->
  <rect x="370" y="730" width="180" height="70" class="external-box" />
  <text x="460" y="750" text-anchor="middle" class="component-title">
    メール配信
  </text>
  <text x="380" y="770" class="component-text">• 通知メール</text>
  <text x="380" y="785" class="component-text">• パスワードリセット</text>
  <text x="380" y="800" class="tech-text">Supabase Auth</text>

  <!-- Analytics -->
  <rect x="590" y="730" width="180" height="70" class="external-box" />
  <text x="680" y="750" text-anchor="middle" class="component-title">
    分析サービス
  </text>
  <text x="600" y="770" class="component-text">• Google Analytics 4</text>
  <text x="600" y="785" class="component-text">• Hotjar (UX分析)</text>
  <text x="600" y="800" class="tech-text">Privacy Compliant</text>

  <!-- Payment (Future) -->
  <rect x="810" y="730" width="180" height="70" class="external-box" />
  <text x="900" y="750" text-anchor="middle" class="component-title">
    決済 (将来)
  </text>
  <text x="820" y="770" class="component-text">• Stripe Integration</text>
  <text x="820" y="785" class="component-text">• サブスクリプション</text>
  <text x="820" y="800" class="tech-text">PCI DSS Compliant</text>

  <!-- CDN -->
  <rect x="1030" y="730" width="180" height="70" class="external-box" />
  <text x="1120" y="750" text-anchor="middle" class="component-title">CDN</text>
  <text x="1040" y="770" class="component-text">• Vercel Edge Network</text>
  <text x="1040" y="785" class="component-text">• Global Distribution</text>
  <text x="1040" y="800" class="tech-text">Edge Computing</text>

  <!-- Infrastructure Layer -->
  <rect x="100" y="860" width="1200" height="100" class="layer-box" />

  <!-- Hosting -->
  <rect x="200" y="880" width="200" height="60" class="infrastructure-box" />
  <text x="300" y="900" text-anchor="middle" class="component-title">
    ホスティング
  </text>
  <text x="210" y="920" class="component-text">• Vercel (Frontend)</text>
  <text x="210" y="935" class="component-text">• Supabase (Backend)</text>

  <!-- Security -->
  <rect x="450" y="880" width="200" height="60" class="infrastructure-box" />
  <text x="550" y="900" text-anchor="middle" class="component-title">
    セキュリティ
  </text>
  <text x="460" y="920" class="component-text">• HTTPS/TLS 1.3</text>
  <text x="460" y="935" class="component-text">• WAF Protection</text>

  <!-- CI/CD -->
  <rect x="700" y="880" width="200" height="60" class="infrastructure-box" />
  <text x="800" y="900" text-anchor="middle" class="component-title">
    CI/CD
  </text>
  <text x="710" y="920" class="component-text">• GitHub Actions</text>
  <text x="710" y="935" class="component-text">• 自動デプロイ</text>

  <!-- Monitoring Infrastructure -->
  <rect x="950" y="880" width="200" height="60" class="infrastructure-box" />
  <text x="1050" y="900" text-anchor="middle" class="component-title">
    監視基盤
  </text>
  <text x="960" y="920" class="component-text">• Uptime Monitoring</text>
  <text x="960" y="935" class="component-text">• Performance Alerts</text>

  <!-- Data Flow Arrows -->
  <!-- Frontend to API -->
  <line x1="350" y1="230" x2="460" y2="310" class="arrow" />
  <text x="405" y="270" class="note-text">HTTPS/REST</text>

  <!-- API to Database -->
  <line x1="460" y1="450" x2="325" y2="530" class="data-arrow" />
  <text x="390" y="490" class="note-text">SQL Queries</text>

  <!-- API to External Services -->
  <line x1="460" y1="450" x2="240" y2="730" class="api-arrow" />
  <text x="350" y="590" class="note-text">YouTube API</text>

  <!-- Frontend to External -->
  <line x1="250" y1="230" x2="240" y2="730" class="api-arrow" />
  <text x="200" y="480" class="note-text">Direct Integration</text>

  <!-- Cache to Database -->
  <line x1="500" y1="590" x2="450" y2="590" class="data-arrow" />
  <text x="475" y="585" class="note-text">Cache</text>

  <!-- Monitoring arrows -->
  <line x1="1000" y1="230" x2="1120" y2="310" class="arrow" />
  <line x1="1120" y1="450" x2="1050" y2="880" class="arrow" />

  <!-- Key Features Panel -->
  <rect
    x="100"
    y="50"
    width="350"
    height="30"
    fill="white"
    stroke="#3D6152"
    stroke-width="1"
    rx="4"
  />
  <text x="110" y="70" class="component-text">
    🚀 スケーラブル • 🔒 セキュア • 📱 レスポンシブ • ⚡ 高パフォーマンス
  </text>

  <!-- Technology Stack Summary -->
  <rect
    x="500"
    y="50"
    width="400"
    height="30"
    fill="white"
    stroke="#C18856"
    stroke-width="1"
    rx="4"
  />
  <text x="510" y="70" class="component-text">
    React + TypeScript + Supabase + YouTube API + Vercel
  </text>

  <!-- Performance Metrics -->
  <rect
    x="950"
    y="50"
    width="350"
    height="30"
    fill="white"
    stroke="#10B981"
    stroke-width="1"
    rx="4"
  />
  <text x="960" y="70" class="component-text">
    📊 目標: 99.9% Uptime • <2s Load Time • 100 Concurrent Users
  </text>
</svg>
